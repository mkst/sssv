#include <ultra64.h>
#include "common.h"


void func_802B8720_6C9DD0(void) {
    D_803D5528->unk380 = 0;
    D_803D5528->unk394 = 0;
    D_803D5528->unk3A8 = 0;
    D_803D5528->unk3BC = 0;
    D_803D5528->unk3C0 = 0;
    D_803D5528->unk382 = 0;
    D_803D5528->unk396 = 0;
    D_803D5528->unk3AA = 0;
    D_803D5528->unk3BE = 0;
    func_802C7BB4_6D9264(4);
}

void func_802B8790_6C9E40(void) {
    D_803D5528->unk380 = 0;
    D_803D5528->unk394 = 0;
    D_803D5528->unk3A8 = 0;
    D_803D5528->unk3BC = 0;
    D_803D5528->unk3C0 = 0;
    D_803D5528->unk382 = 0;
    D_803D5528->unk396 = 0;
    D_803D5528->unk3AA = 0;
    D_803D5528->unk3BE = 0;
    D_803D552C->unk2FA = func_802B8B74_6CA224();
    func_802C7BB4_6D9264(5);
}

void func_802B8810_6C9EC0(void) {
    D_803D5528->unk380 = 0;
    D_803D5528->unk394 = 0;
    D_803D5528->unk3A8 = 0;
    D_803D5528->unk3BC = 0;
    D_803D5528->unk3C0 = 0;
    D_803D5528->unk382 = 0;
    D_803D5528->unk396 = 0;
    D_803D5528->unk3AA = 0;
    D_803D5528->unk3BE = 0;
    D_803D552C->unk2FA = func_802B8B74_6CA224();
    func_802C7BB4_6D9264(6);
}

void func_802B8890_6C9F40(void) {
    D_803D5528->unk380 = 3;
    D_803D5528->unk394 = 3;
    D_803D5528->unk3A8 = 4;
    D_803D5528->unk3BC = 4;
    D_803D5528->unk3C0 = 2;
    D_803D5528->unk3C4 = 2;
    D_803D5528->unk382 = -1;
    D_803D5528->unk396 = -1;
    D_803D5528->unk3AA = -1;
    D_803D5528->unk3BE = -1;
    func_802C7BB4_6D9264(6);
}

void func_802B8918_6C9FC8(void) {
    D_803D5528->unk380 = 7;
    D_803D5528->unk394 = 7;
    D_803D5528->unk3A8 = 7;
    D_803D5528->unk3BC = 7;
    D_803D5528->unk3C0 = 7;
    D_803D5528->unk3C4 = 7;
    D_803D5528->unk382 = 0;
    D_803D5528->unk396 = 0;
    D_803D5528->unk3AA = 0;
    D_803D5528->unk3BE = 0;
}

void func_802B8978_6CA028(void) {
    D_803D5528->unk380 = 8;
    D_803D5528->unk394 = 8;
    D_803D5528->unk3A8 = 8;
    D_803D5528->unk3BC = 8;
    D_803D5528->unk3C0 = 8;
    D_803D5528->unk3C4 = 8;
    D_803D5528->unk382 = 0;
    D_803D5528->unk396 = 0;
    D_803D5528->unk3AA = 0;
    D_803D5528->unk3BE = 0;
}

void func_802B89D8_6CA088(void) {
    D_803D5528->unk3C0 = 9;
    D_803D5528->unk3C4 = 9;
    D_803D5528->unk382 = -1;
    D_803D5528->unk396 = -1;
    D_803D5528->unk3AA = -1;
    D_803D5528->unk3BE = -1;
    D_803D5528->unk3C2 = -1;
    D_803D5528->unk3C6 = -1;
    func_802C7BB4_6D9264(6);
}

void func_802B8A48_6CA0F8(void) {
    D_803D5528->unk380 = 10;
    D_803D5528->unk394 = 10;
    D_803D5528->unk3A8 = 10;
    D_803D5528->unk3BC = 10;
    D_803D5528->unk3C0 = 10;
    D_803D5528->unk3C4 = 10;
    D_803D5528->unk382 = -1;
    D_803D5528->unk396 = -1;
    D_803D5528->unk3AA = -1;
    D_803D5528->unk3BE = -1;
    D_803D5528->unk3C2 = -1;
    D_803D5528->unk3C6 = -1;
    func_802C7BB4_6D9264(6);
}

void func_802B8AD8_6CA188(void) {
    D_803D5528->unk3C0 = 9;
    D_803D5528->unk3C4 = 9;
    D_803D5528->unk3CE = 9;
    D_803D5528->unk3C2 = -1;
    D_803D5528->unk3C6 = -1;
    D_803D5528->unk3D0 = -1;
}

void func_802B8B1C_6CA1CC(void) {
    D_803D5528->unk3C0 = 12;
    D_803D5528->unk3CE = 12;
    D_803D5528->unk3C2 = -1;
    D_803D5528->unk3D0 = -1;
    if (D_803D5528->unk3C4 != 12) {
        D_803D5528->unk3C4 = 12;
        D_803D5528->unk3C6 = -1;
    }
}

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B8B74_6CA224.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B8C50_6CA300.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B901C_6CA6CC.s")
// NON-MATCHING: kinda JUSTREG but not really..
// void func_802B901C_6CA6CC(u8 arg0, s16 *arg1, s16 *arg2) {
//     s16 temp_a3;
//     s16 temp_t1;
//     s16 temp_t2;
//     s16 temp_v0;
//     s32 tmp0;
//     s32 tmp1;
//     temp_v0 = D_80152C78[(u8) arg0];
//     temp_t2 = *arg2;
//     temp_a3 = D_80152C78[(u8) (arg0 + 64)];
//
//     tmp0 = temp_t2 * temp_v0;
//     tmp0 += (*arg1) * temp_a3;
//
//     tmp1 = temp_t2 * temp_a3;
//     tmp1 -= (*arg1) * temp_v0;
//
//     *arg2 = (tmp1 >>= 15);
//     *arg1 = (tmp0 >>= 15);
// }

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B90A0_6CA750.s")
// NON-MATCHING: same issue as previous
// void func_802B90A0_6CA750(u8 arg0, s32 *arg1, s32 *arg2) {
//     s32 temp_t1;
//     s32 temp_t2;
//     s32 new_var3;
//     s32 temp_t4;
//     s32 temp_t5;
//     s32 new_var;
//     s32 new_var2;
//
//     temp_t5 = D_80152C78[(u8) arg0] >> 7;
//     new_var3 = *arg1;
//     temp_t4 = D_80152C78[(u8) (arg0 + 64)] >> 7;
//     new_var = *arg2;
//
//     temp_t2 = new_var * temp_t5;
//     new_var2 = new_var3 * temp_t5;
//     temp_t2 += temp_t4 * (*arg1);
//     temp_t2 >>= 8;
//
//     temp_t1 = temp_t4 * new_var;
//     temp_t1 -= new_var2;
//     temp_t1 >>= 8;
//
//     *arg2 = temp_t1;
//     *arg1 = temp_t2;
// }

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B9130_6CA7E0.s")

void func_802B964C_6CACFC(void) {
    D_80203FE0[1].unk0 = (D_80203FE0[3].unk0 + D_80203FE0[4].unk0) >> 1;
    D_80203FE0[1].unk2 = (D_80203FE0[3].unk2 + D_80203FE0[4].unk2) >> 1;
    D_80203FE0[1].unk4 = (D_80203FE0[3].unk4 + D_80203FE0[4].unk4) >> 1;
    D_80203FE0[2].unk0 = (D_80203FE0[5].unk0 + D_80203FE0[6].unk0) >> 1;
    D_80203FE0[2].unk2 = (D_80203FE0[5].unk2 + D_80203FE0[6].unk2) >> 1;
    D_80203FE0[2].unk4 = (D_80203FE0[5].unk4 + D_80203FE0[6].unk4) >> 1;
}

void func_802B96D0_6CAD80(s16 *arg0, s16 arg1, s16 arg2, s32 arg3) {
    func_802BD358_6CEA08();
    D_80203FE0[2].unk2 = 0;
    D_80203FE0[2].unk0 = D_80203FE0[2].unk2;
    D_80203FE0[2].unk4 = arg2 + *arg0;
    D_80203FE0[1].unk2 = 0;
    D_80203FE0[0].unk2 = 0;
    D_80203FE0[1].unk0 = D_80203FE0[1].unk2;
    D_80203FE0[1].unk4 = (arg1 * 2) + D_80203FE0[2].unk4;
    D_80203FE0[0].unk0 = D_80203FE0[0].unk2;
    D_80203FE0[0].unk4 = (D_80203FE0[1].unk4 + D_80203FE0[2].unk4) >> 1;
}

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B975C_6CAE0C.s")
// NON-MATCHING: 80% there
// void func_802B975C_6CAE0C(s16 *arg0, s16 arg1, s16 arg2) {
//     if ((D_803D5530->state == 3) || (D_803D5530->state == 6) || (D_803D5530->state == 4) ||
//         (D_803D5530->state == 0xB6) || (D_803D5530->state == 0xB9) || (D_803D5530->state == 0xB7) ||
//         (D_803D5530->state == 0x8E) || (D_803D5530->state == 0x90) || (D_803D5530->state == 0x8F)) {
//         D_803D552C->unk2F6 = (D_803D552C->unk2F2 * 256) / (u32) D_803D552C->unk2FA;
//         D_803D552C->unk2F8 = (D_803D552C->unk2F4 * 256) / (u32) D_803D552C->unk2FA;
//     } else {
//         D_803D552C->unk2F6 = D_803D552C->unk2F2;
//         D_803D552C->unk2F8 = D_803D552C->unk2F4;
//     }
//
//     func_802BD358_6CEA08();
//     D_80203FE0[2].unk2 = 0;
//     D_80203FE0[2].unk0 = D_80203FE0[2].unk2;
//     D_80203FE0[2].unk4 = *arg0;
//     D_80203FE0[1].unk2 = 0;
//     D_80203FE0[24].unk2 = 0;
//     D_80203FE0[1].unk0 =  D_80203FE0[1].unk2;
//     D_80203FE0[24].unk0 =  D_80203FE0[24].unk2;
//
//     if ((D_803D5530->state == 3) || (D_803D5530->state == 0xB6) || (D_803D5530->state == 6) || (D_803D5530->state == 0xB9)) {
//         D_80203FE0[1].unk0 += ((arg1 * (D_80152C78[D_803D552C->unk2F6 & 0xFF] >> 7)) >> 8) >> arg2;
//         D_80203FE0[2].unk4 += ((arg1 * (256 - (D_80152C78[(((u16) D_803D552C->unk2F6 * 2) + 64) & 0xFF] >> 7))) >> 8) >> arg2;
//     } else if ((D_803D5530->state == 4) || (D_803D5530->state == 0xB7)) {
//         D_80203FE0[1].unk0 += ((arg1 * ((D_80152C78[D_803D552C->unk2F6 & 0xFF]) >> 7)) >> 8) >> arg2;
//         D_80203FE0[2].unk4 += ((arg1 * (256 - (D_80152C78[(((u16) D_803D552C->unk2F6 * 2) + 64) & 0xFF] >> 7))) >> 8) >> arg2;
//     }
//
//     D_80203FE0[1].unk4 = D_80203FE0[2].unk4 + (arg1 * 2);
//     D_80203FE0[24].unk4 = D_80203FE0[2].unk4 + (arg1 * 2);
//     D_80203FE0[0].unk4 = (D_80203FE0[2].unk4 + D_80203FE0[1].unk4) >> 1;
//     D_80203FE0[0].unk2 = 0;
//     D_80203FE0[0].unk0 = D_80203FE0[0].unk2;
// }

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B9A5C_6CB10C.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802B9D20_6CB3D0.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BA220_6CB8D0.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BA614_6CBCC4.s")

void func_802BAA38_6CC0E8(u16 arg0, u16 arg1) {
    D_80203FE0[3].unk4 = 0;
    D_80203FE0[3].unk0 = -arg1;
    D_80203FE0[4].unk4 = 0;
    D_80203FE0[5].unk2 = -arg0;
    D_80203FE0[5].unk0 = -arg1;
    D_80203FE0[5].unk4 = 0;
    D_80203FE0[6].unk2 = -arg0;
    D_80203FE0[6].unk4 = 0;
    D_80203FE0[4].unk0 = arg1;
    D_80203FE0[6].unk0 = arg1;
    D_80203FE0[3].unk2 = arg0;
    D_80203FE0[4].unk2 = arg0;
    func_802C79E0_6D9090(&D_80203FF8, -D_803D5530->unk28);
    func_802C79E0_6D9090(&D_80204000, -D_803D5530->unk28);
    func_802C79E0_6D9090(&D_80204008, -D_803D5530->unk28);
    func_802C79E0_6D9090(&D_80204010, -D_803D5530->unk28);
    D_80203FE0[3].unk4 = (D_80203FE0[3].unk4 + (D_803D5524->unkB8 << 5));
    D_80203FE0[4].unk4 = (D_80203FE0[4].unk4 + (D_803D5524->unkB8 << 5));
    D_80203FE0[5].unk4 = (D_80203FE0[5].unk4 + (D_803D5524->unkB8 << 5));
    D_80203FE0[6].unk4 = (D_80203FE0[6].unk4 + (D_803D5524->unkB8 << 5));
    D_80203FE0[1].unk0 = ((D_80203FE0[3].unk0 + D_80203FE0[4].unk0) >> 1);
    D_80203FE0[1].unk2 = ((D_80203FE0[3].unk2 + D_80203FE0[4].unk2) >> 1);
    D_80203FE0[1].unk4 = ((D_80203FE0[3].unk4 + D_80203FE0[4].unk4) >> 1);
    D_80203FE0[2].unk0 = ((D_80203FE0[5].unk0 + D_80203FE0[6].unk0) >> 1);
    D_80203FE0[2].unk2 = ((D_80203FE0[5].unk2 + D_80203FE0[6].unk2) >> 1);
    D_80203FE0[2].unk4 = ((D_80203FE0[5].unk4 + D_80203FE0[6].unk4) >> 1);
    D_80203FE0[0].unk2 = 0;
    D_80203FE0[0].unk0 = D_80203FE0[0].unk2;
    D_80203FE0[0].unk4 = ((D_80203FE0[1].unk4 + D_80203FE0[2].unk4) >> 1);
}

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BAC24_6CC2D4.s")

void func_802BAD60_6CC410(u16 arg0, u16 arg1) {
    s32 temp_t9;
    s16 phi_a0;
    Animal * a;

    D_80203FE0[1].unk0 = 0;
    D_80203FE0[1].unk2 = arg0;
    D_80203FE0[1].unk4 = arg1;
    D_80203FE0[2].unk0 = 0;
    D_80203FE0[2].unk2 = -arg0;
    D_80203FE0[2].unk4 = arg1;
    D_80203FE0[0].unk2 = 0;
    D_80203FE0[0].unk0 = D_80203FE0[0].unk2;
    D_80203FE0[0].unk4 = arg1;

    if ((u16)D_803D5528->unk3C4 == 13) {
        phi_a0 = MIN(D_803D5528->unk3C6, 8);
        phi_a0 = phi_a0 * 32;
        temp_t9 = ((D_80152C78[(u8) phi_a0] >> 7) * arg0) >> 9;
        D_80203FE0[1].unk4 += temp_t9;
        D_80203FE0[2].unk4 += temp_t9;
    }
}

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BAE24_6CC4D4.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BB1F0_6CC8A0.s")

#pragma GLOBAL_ASM("asm/nonmatchings/overlay2_6C9DD0/func_802BB70C_6CCDBC.s")
// JUSTREG
// void func_802BB70C_6CCDBC(s16 arg0, s16 arg1) {
//     u16 tmp = (arg0 + arg1);
//     D_80203FE0[22].unk0 = arg0;
//     D_80203FE0[22].unk2 = 0;
//     D_80203FE0[22].unk4 = 0;
//     D_80203FE0[24].unk0 = -arg0;
//     D_80203FE0[24].unk2 = 0;
//     D_80203FE0[24].unk4 = 0;
//     D_80203FE0[23].unk0 = tmp;
//     D_80203FE0[23].unk2 = 0;
//     D_80203FE0[23].unk4 = 0;
//     D_80203FE0[25].unk0 = -tmp;
//     D_80203FE0[25].unk2 = 0;
//     D_80203FE0[25].unk4 = 0;
//     if (D_803F2D10.unk0 == 0) {
//         func_802DB9E8_6ED098(&D_803D552C->unk30C, (s16)(D_803D552C->unk306 * 15), 4);
//     }
//     func_802C7A7C_6D912C(&D_80204090, D_803D552C->unk30C);
//     func_802C7A7C_6D912C(&D_80204098, D_803D552C->unk30C);
//     func_802C7A7C_6D912C(&D_802040A0, D_803D552C->unk30C);
//     func_802C7A7C_6D912C(&D_802040A8, D_803D552C->unk30C);
//     D_80203FE0[22].unk4 += D_80203FE0[0].unk4;
//     D_80203FE0[23].unk4 += D_80203FE0[0].unk4;
//     D_80203FE0[24].unk4 += D_80203FE0[0].unk4;
//     D_80203FE0[25].unk4 += D_80203FE0[0].unk4;
// }
